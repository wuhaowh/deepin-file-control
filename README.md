[产品说明文档](https://github.com/xiyou-linuxer/deepin-file-control#xfilecontorl%E4%BA%A7%E5%93%81%E8%AF%B4%E6%98%8E%E6%96%87%E6%A1%A3)

## 关于我们：
![aboutUs](https://github.com/xiyou-linuxer/deepin-file-control/blob/master/about_us.jpg)

## 获奖情况：
![award](https://github.com/xiyou-linuxer/deepin-file-control/blob/master/award.jpg)

# xFileContorl产品说明文档

* <a href="#1">一、背景 </a>
* <a href="#2">二、简介 </a>
* <a href="#3">三、产品概述 </a>
* <a href="#4">四、产品特性 </a>
* <a href="#5">五、代码框架 </a>
* <a href="#6">六、操作手册</a>
* <a href="#7">七、问题反馈联系方式</a>
* <a href="#8">八、源代码地址</a>

## <a name="1">一、背景</a>

### 1. 2019年深度软件开发大赛介绍

   深度操作系统是由中国研发团队主导开发的一款基于Linux的操作系统软件，经过十多年的技术沉淀和版本迭代，产品已日趋完善，并在国内外引起了广泛的关注。深度操作系统目前已支持33种语言，拥有7个海外用户社区，全球用户过百万。  为完善深度操作系统和国产芯片（CPU）下的软件生态，武汉深之度科技有限公司（以下简称深度科技）将于2019年3月举办“深度软件开发大赛”。本次大赛在中国电子工业标准化技术协会信息技术应用创新工作委员会、中国智能终端操作系统联盟的支持和指导下，联合国内优秀的软硬件厂商龙芯中科、华为、成都申威等共同举办，本次大赛也将邀请全国高校及开源组织共同参与。大赛将向全球的开发者征集原创软件作品，丰富国产软件生态。  本次大赛得到了国产芯片厂商的大力支持，并为参赛团队准备了基于龙芯、申威平台的终端硬件开发环境，以开发桌面软件；同时还准备了基于华为鲲鹏处理器的TaiShan服务器硬件开发环境，以便于开发服务端软件。参赛团队可以率先体验和使用国产桌面终端和国产服务器整机，成为国产平台软件开发的先锋。

### 2. 题目介绍

#### 2.1 题目

文件管控客户端

#### 2.2 题目要求

在桌面操作系统中开发文件监视工具。监视工具指定的目录下，读取收到严格控制和限制。

具体包括：
      1.监视和记录制定目录下文件是否被打开（open）和关闭（close）。 
      2.当这些文件被open和close时，文件监视工具可以作为客户端，向指定的监视服务器的控制模块（称为server）发送一个文件事件信息，文件事件信息的内容包括：文件句柄和操作方式。
      3.在配置了制定的监视服务器情况下，需等待server对该文件指令，并根据制定执行操作。操作包括：读取，删除，重写等。
      4.当监视服务器关闭或者网络不通时，client直接拒绝任何操作，不允许任何人打开文件。
      5.当没有配置指定的监视服务器情况下，根据本地配置默认权限执行操作。
      有条件的情况下，建议完成监视服务器（server）端的开发工作：
      1.监视服务器上的控制模块server接收到桌面操作系统客户端上传的文件事件时，如果是文件操作是打开，修改终端系统中该文件内容为“It is a secret”。 
      2.当server接收到文件关闭的事件时，将文件的原始内容再恢复回去。
      注意： 桌面操作系统终端上可能有不同的进程同时打开多个收控制的文件； server端也可能同时接收多台终端的客户端程序的请求。 要求使用C/C++代码实现client和server端的程序的上述功能。 
      
#### 2.3 基本场景如下

 1.放置一个文件在终端机上，内容自定。
 2.给终端中的文件监视工具配置受控文件路径和监视服务器地址，确保文件监视工具和监视服务器控制模块程序正常运行。
 3.编写测试代码open并read文件内容，读出的文件内容为“It is a secret”。
 4.编写测试代码close文件。
 5.监视工具程序退出。测试代码再次读取该文件，文件内容为原始内容。
 6.再次启动监视工具程序，关闭server程序。再次使用测试代码打开文件时失败。
 7.打开server程序。测试代码再次open并read文件，读出的文件内容为“It is a secret”。

### 3. 团队介绍
 #### 3.1 成员介绍
 - 队长：[马艺诚](https://github.com/ghorges)
 - 队员：[胡锦雲](https://github.com/okokme)、[胡佳露](https://github.com/jialuhu)、[朱一琛](https://github.com/yaomer)
 #### 3.2 分工详情
 ##### 3.2.1 客户端
 客户端主要由成员马艺诚、胡佳露完成。其中基于Ring3的Hook模块与TCP、Unix代码逻辑关系（即各功能模块接口）由成员胡佳露给出。成员马艺诚负责总客户端具体某函数模块的实现以及代码的总汇。由于客户端环境的特殊性，以及比赛资源的限制性，客户端代码统一由马艺诚成员GitHub账号上传至GitHub。该客户端的一切开发环境基于主办方为团队提供的主机。
 #### 3.2.2 服务端
 服务端主要由成员朱一琛、胡锦雲完成。其中文件备份的压缩加密传输以及解压解密下载代码模块由成员胡锦雲完成并且提供其他成员使用。成员朱一琛负责完成基于高性能和多线程的服务端主要逻辑代码块（网络库）的开发。由于服务端的代码使用了C++11编程以及boost库，对编译器有一定的要求。该服务端部署在拥有gcc version 7.3.0 (Debian 7.3.0-19)的深度操作系统上。
 
 
## <a name="2">二、简介</a>


xFileContorl是一款以MIT协议进行开源的、基于Deepin GNU/Linux下开发，专为Deepin操作系统打造的文件控制器。

xFileContorl 1.0 已经具备文件监视的能力， 用户可以监视指定目录下文件的读取，使读取文件信息受到严格的限制，当打开一个已经被检测到的文件时，该文件内容被修改为“it is a secret”。

xFileContorl客户端工具并不仅仅是监听文件系统事件并上报的功能，而是有权限对文件操作进行过滤、上报甚至拒绝的“保险箱”工具。

目前来看，对于有安全性的需求的、希望使用轻量简约风格客户端的用户，会被此产品吸引并使用。

对于用户而言，xFileContorl 1.0 会有用户门槛等问题。与此同时，主办方向开发团队提供了国产终端硬件开发环境。

依据以上信息，进行了xFileContorl第二期的开发，即为xFileContorl2.0进行国产平台计算机软件移植、增加简易用户引导，优化传输大文件速度控制，支持加密传输等等。


### 1. 目的

此文档的目的是为使用该产品的开发人员提供直观、清晰、有逻辑、有层次的定义各个模块的内容来源和相关的逻辑、背景、优先级。



### 2. 范围

此文档主要描述xFileContorl产品的功能点，交互逻辑与细节，主要读者为研发人员。


## <a name="3">三、产品概述</a>


​	本产品面对的用户主要使用文件监视客户端，文件监控的服务端主要由研发人员设置使用。

​	打开xFileContorl后，输入想要检测的目录进行监控后，再去打开此目录下文件 会显示 it's a secret。

​	客户端主要用来监视和记录指定目录下文件的打开和关闭动作（文件系统事件open 和 close），并上报服务端（文件路径、文件句柄、操作方式等）。客户端在配置了指定的监视服务器情况下，可接受服务端下发的文件操作指令。当监视服务器关闭或者网络不通时，客户端拒绝任何操作，不允许任何人打开文件（拒绝监视目录的一切文件操作）。监视服务器不存在或者未配置时，记录相关的操作到日志文件，监视服务器可以查询历史操作日志。


### 1. 总体框图

#### 1.1 示意图





![sc2](https://img-blog.csdnimg.cn/20190823021925358.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2tra2tkZQ==,size_16,color_FFFFFF,t_70)

![sc](https://github.com/okokme/project/blob/master/deepin-file/sc.jpg)



#### 1.2 效果

客户端：

![](https://github.com/okokme/project/blob/master/deepin-file/client1.jpg)


服务端：

![](https://github.com/okokme/project/blob/master/deepin-file/server.jpg)

#### 1.3 流程

####
